{
    "$schema":"http://json-schema.org/draft-07/schema#",
    "description":"Information about an external identifier.",
    "additionalProperties":false,
    "required":[
        "external_identifier",
        "identifier_source"
    ],
    "title":"External Identifier",
    "name":"external_identifier",
    "type":"object",
    "properties":{
        "describedBy":{
            "description":"The URL reference to the schema.",
            "type":"string",
            "pattern":"^(http|https)://schema.(.*?)humancellatlas.org/module/project/((\\d{1,}.\\d{1,}.\\d{1,})|([a-zA-Z]*?))/funder"
        },
        "schema_version":{
            "description":"The version number of the schema in major.minor.patch format.",
            "type":"string",
            "pattern":"^\\d{1,}.\\d{1,}.\\d{1,}$",
            "example":"4.6.1"
        },
        "external_identifier":{
            "description":"Any unique identifier that identifies the project, dataset, experiment, biomaterial or protocol.",
            "type":"string",
            "example":"SCP464; E-MTAB-8901",
            "user_friendly":"External Identifier",
            "guidelines":"Enter an identifier including and accession from one of the listed sources. If source not present, select 'other'."
        },
        "identifier_source":{
            "description":"The source of the unique identifier.",
            "type":"string",
            "enum":[
                "insdc_study",
                "insdc_project",
                "insdc_sample",
                "insdc_experiment",
                "biosamples",
                "indsc_run",
                "ega_study",
                "ega_dataset",
                "ega_sample",
                "arrayexpress",
                "scea",
                "scp",
                "geo_series",
                "dbgap",
                "cbtm",
                "hdbr",
                "biostudies",
                "other"
            ],
            "user_friendly":"Identifer Source",
            "guidelines":"Choose the source of the identifier, if source isn't listed select 'other'"
        },
        "other_explanation":{
            "description":"An explanation of the source of the identifier.",
            "type":"string",
            "example":"Identifier used for internal tracking.",
            "user_friendly":"Other explanation",
            "guidelines":"If you selected 'other' explain the source of the identifier."
        }
    },
    "allOf":[
        {
            "if":{
                "properties":{
                    "identifier_source":{
                        "const":"insdc_study"
                    }
                }
            },
            "then":{
                "properties":{
                    "external_identifier":{
                        "pattern":"^(E|D|S)RP\\d{6,}$"
                    }
                }
            }
        },
        {
            "if":{
                "properties":{
                    "identifier_source":{
                        "const":"insdc_project"
                    }
                }
            },
            "then":{
                "properties":{
                    "external_identifier":{
                        "pattern":"^PRJ(E|D|N)[A-Z]\\d+$"
                    }
                }
            }
        },
        {
            "if":{
                "properties":{
                    "identifier_source":{
                        "const":"insdc_sample"
                    }
                }
            },
            "then":{
                "properties":{
                    "external_identifier":{
                        "pattern":"^(E|D|S)RS\\d{6,}$"
                    }
                }
            }
        },
        {
            "if":{
                "properties":{
                    "identifier_source":{
                        "const":"insdc_experiment"
                    }
                }
            },
            "then":{
                "properties":{
                    "external_identifier":{
                        "pattern":"^(E|D|S)RX\\d{6,}$"
                    }
                }
            }
        },
        {
            "if":{
                "properties":{
                    "identifier_source":{
                        "const":"insdc_run"
                    }
                }
            },
            "then":{
                "properties":{
                    "external_identifier":{
                        "pattern":"^(E|D|S)RR\\d{6,}$"
                    }
                }
            }
        },
        {
            "if":{
                "properties":{
                    "identifier_source":{
                        "const":"biosamples"
                    }
                }
            },
            "then":{
                "properties":{
                    "external_identifier":{
                        "pattern":"^SAM(E|D|N)[A-Z]?\\d+$"
                    }
                }
            }
        },
        {
            "if":{
                "properties":{
                    "identifier_source":{
                        "const":"ega_study"
                    }
                }
            },
            "then":{
                "properties":{
                    "external_identifier":{
                        "pattern":"^EGAS\\d{11}$"
                    }
                }
            }
        },
        {
            "if":{
                "properties":{
                    "identifier_source":{
                        "const":"ega_dataset"
                    }
                }
            },
            "then":{
                "properties":{
                    "external_identifier":{
                        "pattern":"^EGAD\\d{11}$"
                    }
                }
            }
        },
        {
            "if":{
                "properties":{
                    "identifier_source":{
                        "const":"ega_sample"
                    }
                }
            },
            "then":{
                "properties":{
                    "external_identifier":{
                        "pattern":"^EGAN\\d{11}$"
                    }
                }
            }
        },
        {
            "if":{
                "properties":{
                    "identifier_source":{
                        "const":"arrayexpress"
                    }
                }
            },
            "then":{
                "properties":{
                    "external_identifier":{
                        "pattern":"^E-[A-Z]{4}-\\d+$"
                    }
                }
            }
        },
        {
            "if":{
                "properties":{
                    "identifier_source":{
                        "const":"scea"
                    }
                }
            },
            "then":{
                "properties":{
                    "external_identifier":{
                        "pattern":"^E-[A-Z]{4}-\\d+$"
                    }
                }
            }
        },
        {
            "if":{
                "properties":{
                    "identifier_source":{
                        "const":"scp"
                    }
                }
            },
            "then":{
                "properties":{
                    "external_identifier":{
                        "pattern":"^SCP\\d+$"
                    }
                }
            }
        },
        {
            "if":{
                "properties":{
                    "identifier_source":{
                        "const":"geo_series"
                    }
                }
            },
            "then":{
                "properties":{
                    "external_identifier":{
                        "pattern":"^GSE\\d+$"
                    }
                }
            }
        },
        {
            "if":{
                "properties":{
                    "identifier_source":{
                        "const":"dbgap"
                    }
                }
            },
            "then":{
                "properties":{
                    "external_identifier":{
                        "pattern":"^phs\\d{6}(\\.v\\d{1})?(\\.p\\d)?$"
                    }
                }
            }
        },
        {
            "if":{
                "properties":{
                    "identifier_source":{
                        "const":"cbtm"
                    }
                }
            },
            "then":{
                "properties":{
                    "external_identifier":{
                        "pattern":"^\\d{3}\\w+$"
                    }
                }
            }
        },
        {
            "if":{
                "properties":{
                    "identifier_source":{
                        "const":"hdbr"
                    }
                }
            },
            "then":{
                "properties":{
                    "external_identifier":{
                        "pattern":"^\\d+$"
                    }
                }
            }
        },
        {
            "if":{
                "properties":{
                    "identifier_source":{
                        "const":"biostudies"
                    }
                }
            },
            "then":{
                "properties":{
                    "external_identifier":{
                        "pattern":"^S-[A-Z]{4}\\d+$"
                    }
                }
            }
        },
        {
            "if":{
                "properties":{
                    "identifier_source":{
                        "const":"other"
                    }
                }
            },
            "then":{
                "properties":{
                    "other_explanation":{
                        "pattern":"[a-zA-Z]+"
                    }
                }
            }
        }
    ]
}